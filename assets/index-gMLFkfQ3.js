(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const e of r)if(e.type==="childList")for(const c of e.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function i(r){const e={};return r.integrity&&(e.integrity=r.integrity),r.referrerPolicy&&(e.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?e.credentials="include":r.crossOrigin==="anonymous"?e.credentials="omit":e.credentials="same-origin",e}function a(r){if(r.ep)return;r.ep=!0;const e=i(r);fetch(r.href,e)}})();async function ae(t){if(t.length===0)return"";const s=new Blob([t]).stream().pipeThrough(new CompressionStream("gzip")),i=new Uint8Array(await new Response(s).arrayBuffer()),a=Array.from(i,r=>String.fromCodePoint(r)).join("");return btoa(a)}async function ie(t){if(t.length===0)return"";const s=atob(t),i=Uint8Array.from(s,a=>a.charCodeAt(0));try{const a=new Blob([i]).stream().pipeThrough(new DecompressionStream("gzip"));return await new Response(a).text()}catch{return new TextDecoder().decode(i)}}async function le(){const t=(await he()??ge())?.content||"";return pe(),t}function de(t){const s={content:t};localStorage.setItem("editorState",JSON.stringify(s))}function ue(){try{const t=localStorage.getItem("caretPosition");return t!==null?parseInt(t,10):0}catch{return 0}}function fe(t){localStorage.setItem("caretPosition",String(t))}function pe(){window.history.replaceState(null,"",window.location.pathname)}async function he(){const t=window.location.hash,s="#doc=";try{if(t.startsWith(s)){const i=decodeURIComponent(t.substring(s.length));if(i.startsWith("https://")||i.startsWith("http://"))return await me(i);const a=await ie(i);return JSON.parse(a)}return null}catch(i){return console.error("Error loading document from URL:",i.message),null}}async function me(t){const s=await fetch(t);if(!s.ok)throw new Error(`Failed to fetch document: ${s.status} ${s.statusText}`);const i=await s.text();try{const a=JSON.parse(i);if(a.content!==void 0)return a}catch{}return{content:i}}function ge(){const t=localStorage.getItem("editorState");if(!t)return null;try{return JSON.parse(t)}catch(s){return console.error("Error parsing saved state",s),null}}const M=2,ye=/^(\s*(?:>\s*)*)([-*+] (?:\[[ xX]\] )?|\d+\. )?/;function P(t,s){let i=s;for(;i>0&&t[i-1]!==`
`;)i--;return i}function I(t,s){let i=s;for(;i<t.length&&t[i]!==`
`;)i++;return i}function xe(t){const s=t.match(ye),i=s[1]||"",a=s[2]||"";return{prefix:i+a,structural:i,marker:a}}function $e(t,s,i){if(!i.match(/^[-=]+\s*$/)||s===0)return!1;const a=P(t,s-1),r=t.slice(a,s-1);if(r===""||r.match(/^\s*(---+|\*\*\*+|___+)\s*$/)||r.match(/^- /))return!1;if(a>0){const e=P(t,a-1);if(t.slice(e,a-1)!=="")return!1}return!0}function we(t,s){if(!s)return t;const i=s.match(/^([-*+] )\[[ xX]\] $/);if(i)return t+i[1]+"[ ] ";const a=s.match(/^(\d+)\. $/);if(a){const r=parseInt(a[1],10)+1;return t+r+". "}return t+s}function be(t,s,i){const a=P(t,s),r=I(t,i),e=t.slice(a,r);if($e(t,a,e))return{text:t.slice(0,s)+`
`+t.slice(i),offset:s+1};const{prefix:c,structural:f,marker:p}=xe(e);if(c.length===0)return{text:t.slice(0,s)+`
`+t.slice(i),offset:s+1};const m=e.slice(c.length),T=s<=a+c.length;if(m.trim()===""&&T)return{text:t.slice(0,a)+t.slice(a+c.length),offset:a};const $=we(f,p);return{text:t.slice(0,s)+`
`+$+t.slice(i),offset:s+1+$.length}}function Te(t,s){const i=P(t,s),r=t.slice(i,I(t,s)).match(/^\s*/)[0].length,e=s-i,c=" ".repeat(M);return e<=r?{text:t.slice(0,i)+c+t.slice(i),offset:s+M}:{text:t.slice(0,s)+c+t.slice(s),offset:s+M}}function ve(t,s){const i=P(t,s),r=t.slice(i,I(t,s)).match(/^\s*/)[0].length,e=Math.min(r,M);if(e===0)return{text:t,offset:s};const c=t.slice(0,i)+t.slice(i+e),f=Math.max(i,s-e);return{text:c,offset:f}}function ke(t,s,i,a,r={}){let e=s;const c=[],f=[];let p=0,m="",T=!1;function k(o){t.innerHTML=i(o)}function $(o,n,l){if(n===o){let g=0;const C=Math.min(l,o.childNodes.length);for(let E=0;E<C;E++)g+=o.childNodes[E].textContent.length,E<o.childNodes.length-1&&(g+=1);return g}let u=n;for(;u&&u.parentNode!==o;)u=u.parentNode;if(!u)return 0;let h=0;for(let g=o.firstChild;g&&g!==u;g=g.nextSibling)h+=g.textContent.length+1;try{const g=document.createRange();g.setStart(u,0),g.setEnd(n,l),h+=g.toString().length}catch{}return h}function b(){const o=window.getSelection();return o.rangeCount?$(t,o.focusNode,o.focusOffset):0}function v(){const o=window.getSelection();if(!o.rangeCount)return{start:0,end:0};const n=$(t,o.anchorNode,o.anchorOffset),l=$(t,o.focusNode,o.focusOffset);return{start:Math.min(n,l),end:Math.max(n,l)}}function S(o){const n=window.getSelection(),l=Array.from(t.children);if(l.length===0){n.collapse(t,0);return}let u=o;for(let E=0;E<l.length;E++){const N=l[E],H=N.textContent.length;if(u<=H){const D=document.createTreeWalker(N,NodeFilter.SHOW_TEXT);for(;D.nextNode();){const O=D.currentNode.textContent.length;if(u<=O){n.collapse(D.currentNode,u);return}u-=O}n.collapse(N,0);return}if(u-=H,E<l.length-1){if(u===0){const D=document.createTreeWalker(N,NodeFilter.SHOW_TEXT);let O=null;for(;D.nextNode();)O=D.currentNode;O?n.collapse(O,O.textContent.length):n.collapse(N,N.childNodes.length);return}u-=1}}const h=l[l.length-1],g=document.createTreeWalker(h,NodeFilter.SHOW_TEXT);let C=null;for(;g.nextNode();)C=g.currentNode;C?n.collapse(C,C.textContent.length):n.collapse(h,h.childNodes.length)}function _(){const o=window.getSelection();if(!o.rangeCount)return;const n=o.getRangeAt(0).getBoundingClientRect();if(!n||n.height===0)return;const l=40,u=window.innerHeight;n.bottom>u-l?window.scrollBy({top:n.bottom-u+l,behavior:"smooth"}):n.top<l&&window.scrollBy({top:n.top-l,behavior:"smooth"})}function y(o,n){const l=Date.now();if(o===m&&l-p<500&&c.length>0){p=l;return}c.push({text:e,offset:n}),f.length=0,p=l,m=o}function B(){if(c.length===0)return;f.push({text:e,offset:b()});const o=c.pop();e=o.text,k(e),S(o.offset),_(),a(e)}function K(){if(f.length===0)return;c.push({text:e,offset:b()});const o=f.pop();e=o.text,k(e),S(o.offset),_(),a(e)}function J(o){if(o===0)return 0;let n=o;for(;n>0&&/\s/.test(e[n-1]);)n--;for(;n>0&&!/\s/.test(e[n-1]);)n--;return n}function Z(o){const n=e.length;if(o>=n)return n;let l=o;for(;l<n&&!/\s/.test(e[l]);)l++;for(;l<n&&/\s/.test(e[l]);)l++;return l}function V(o){if(o===0)return 0;let n=o;for(;n>0&&e[n-1]!==`
`;)n--;return n}function G(o){const n=e.length;if(o>=n)return n;let l=o;for(;l<n&&e[l]!==`
`;)l++;return l}function j(o){const n=o.length,{start:l,end:u}=v();if(!(l!==u)){y("format",l),e=e.slice(0,l)+o+o+e.slice(l),x(l+n);return}const g=e.slice(l-n,l),C=e.slice(u,u+n);g===o&&C===o?(y("format",l),e=e.slice(0,l-n)+e.slice(l,u)+e.slice(u+n),x(u-n)):(y("format",l),e=e.slice(0,l)+o+e.slice(l,u)+o+e.slice(u),x(u+n+n))}function x(o){k(e),S(o),_(),a(e),r.onCaretChange?.(o)}function Q(o){if(T||o.inputType==="insertCompositionText"||(o.preventDefault(),o.inputType==="insertFromPaste"||o.inputType==="deleteByCut"))return;const{start:n,end:l}=v(),u=n!==l;switch(o.inputType){case"insertText":{const h=o.data||"";y("insertText",n),e=e.slice(0,n)+h+e.slice(l),x(n+h.length);break}case"insertParagraph":case"insertLineBreak":{y("insertLine",n);const h=be(e,n,l);e=h.text,x(h.offset);break}case"deleteContentBackward":{u?(y("delete",n),e=e.slice(0,n)+e.slice(l),x(n)):n>0&&(y("delete",n),e=e.slice(0,n-1)+e.slice(n),x(n-1));break}case"deleteContentForward":{u?(y("delete",n),e=e.slice(0,n)+e.slice(l),x(n)):n<e.length&&(y("delete",n),e=e.slice(0,n)+e.slice(n+1),x(n));break}case"deleteWordBackward":{if(u)y("deleteWord",n),e=e.slice(0,n)+e.slice(l),x(n);else{const h=J(n);h<n&&(y("deleteWord",n),e=e.slice(0,h)+e.slice(n),x(h))}break}case"deleteWordForward":{if(u)y("deleteWord",n),e=e.slice(0,n)+e.slice(l),x(n);else{const h=Z(n);h>n&&(y("deleteWord",n),e=e.slice(0,n)+e.slice(h),x(n))}break}case"deleteSoftLineBackward":case"deleteHardLineBackward":{if(u)y("deleteLine",n),e=e.slice(0,n)+e.slice(l),x(n);else{const h=V(n);h<n&&(y("deleteLine",n),e=e.slice(0,h)+e.slice(n),x(h))}break}case"deleteSoftLineForward":case"deleteHardLineForward":{if(u)y("deleteLine",n),e=e.slice(0,n)+e.slice(l),x(n);else{const h=G(n);h>n&&(y("deleteLine",n),e=e.slice(0,n)+e.slice(h),x(n))}break}case"historyUndo":{B();break}case"historyRedo":{K();break}case"insertReplacementText":{const h=o.getTargetRanges();if(h.length>0){const g=h[0],C=$(t,g.startContainer,g.startOffset),E=$(t,g.endContainer,g.endOffset),N=o.dataTransfer?.getData("text/plain")||o.data||"";y("replace",C),e=e.slice(0,C)+N+e.slice(E),x(C+N.length)}break}}}function Y(){T=!0}function ee(){T=!1;const o=b();e=Array.from(t.children).map(n=>n.textContent).join(`
`),k(e),S(o),a(e)}function te(o){o.preventDefault();const{start:n,end:l}=v();n!==l&&o.clipboardData.setData("text/plain",e.slice(n,l))}function ne(o){o.preventDefault();const{start:n,end:l}=v();n!==l&&(o.clipboardData.setData("text/plain",e.slice(n,l)),y("cut",n),e=e.slice(0,n)+e.slice(l),x(n))}function se(o){o.preventDefault();const n=o.clipboardData.getData("text/plain");if(!n)return;const{start:l,end:u}=v();y("paste",l),e=e.slice(0,l)+n+e.slice(u),x(l+n.length)}function oe(o){if((o.metaKey||o.ctrlKey)&&o.key==="z"&&(o.preventDefault(),o.shiftKey?K():B()),(o.metaKey||o.ctrlKey)&&o.key==="b"&&(o.preventDefault(),j("**")),(o.metaKey||o.ctrlKey)&&o.key==="i"&&(o.preventDefault(),j("_")),o.key==="Tab"){o.preventDefault();const{start:n,end:l}=v(),u=n!==l;if(o.shiftKey){y("outdent",n);const h=ve(e,n);e=h.text,x(h.offset)}else if(u)y("indent",n),e=e.slice(0,n)+"  "+e.slice(l),x(n+2);else{y("indent",n);const h=Te(e,n);e=h.text,x(h.offset)}}if(o.key==="ArrowRight"&&!o.metaKey&&!o.ctrlKey&&!o.altKey&&!o.shiftKey){const n=window.getSelection();if(n.rangeCount&&n.isCollapsed&&n.focusNode?.nodeType===Node.TEXT_NODE){const l=n.focusNode,u=n.focusOffset,h=l.parentElement?.closest(".list-marker");if(h&&R(h,l)){const g=h.nextElementSibling;g?.classList.contains("list-content")&&g.textContent.length>0&&(u===l.textContent.length?(o.preventDefault(),S(b()+1)):u===l.textContent.length-1&&(o.preventDefault(),W(g)))}}}if(o.key==="ArrowLeft"&&!o.metaKey&&!o.ctrlKey&&!o.altKey&&!o.shiftKey){const n=window.getSelection();if(n.rangeCount&&n.isCollapsed&&n.focusNode?.nodeType===Node.TEXT_NODE){const l=n.focusNode;if(n.focusOffset===0){const u=l.parentElement?.closest(".list-content");if(u&&ce(u,l)&&u.previousElementSibling?.classList.contains("list-marker")){o.preventDefault();const g=b();g>0&&S(g-1)}}}}(o.key==="ArrowUp"||o.key==="ArrowDown")&&!o.metaKey&&!o.ctrlKey&&!o.altKey&&!o.shiftKey&&requestAnimationFrame(re)}function R(o,n){const l=document.createTreeWalker(o,NodeFilter.SHOW_TEXT);let u=null;for(;l.nextNode();)u=l.currentNode;return u===n}function ce(o,n){return document.createTreeWalker(o,NodeFilter.SHOW_TEXT).nextNode()===n}function W(o){const l=document.createTreeWalker(o,NodeFilter.SHOW_TEXT).nextNode();l&&window.getSelection().collapse(l,0)}function re(){const o=window.getSelection();if(!o.rangeCount||!o.isCollapsed)return;const n=o.focusNode;if(!n||n.nodeType!==Node.TEXT_NODE||o.focusOffset!==n.textContent.length)return;const l=n.parentElement?.closest(".list-marker");if(!l||!R(l,n))return;const u=l.nextElementSibling;!u?.classList.contains("list-content")||u.textContent.length===0||W(u)}t.addEventListener("keydown",oe),t.addEventListener("beforeinput",Q),t.addEventListener("compositionstart",Y),t.addEventListener("compositionend",ee),t.addEventListener("copy",te),t.addEventListener("cut",ne),t.addEventListener("paste",se),k(e);const F=Math.min(r.initialCaretPosition??0,e.length);if(F>0){S(F);const o=window.getSelection();if(o.rangeCount){const n=o.getRangeAt(0).getBoundingClientRect();if(n&&n.height>0){const l=window.innerHeight/2;window.scrollBy({top:n.top-l})}}}return document.addEventListener("selectionchange",()=>{if(!r.onCaretChange)return;const o=window.getSelection();o.rangeCount&&t.contains(o.focusNode)&&r.onCaretChange(b())}),{getText:()=>e}}const w={escaped:/\\([\\`*_{}\[\]()#+\-.!~^|$])/g,inlineCode:new RegExp("(?<!`)`(?!`)([^`\\n]+?)`(?!`)","g"),inlineMath:new RegExp("(?<!\\$)\\$(?!\\$)([^\\$\\n]+?)\\$(?!\\$)","g"),comment:/<!--([\s\S]*?)-->/g,boldItalic:/\*\*\*([^\s\*](?:[^\*\n]*?[^\s\*])?)\*\*\*/g,bold:/\*\*([^\s\*](?:[^\*\n]*?[^\s\*])?)\*\*/g,boldUnderscore:/__([^\s_](?:[^_\n]*?[^\s_])?)__/g,italicAsterisk:new RegExp("(?<!\\*)\\*(?!\\*)([^\\s\\*](?:[^\\*\\n]*?[^\\s\\*])?)\\*(?!\\*)","g"),italicUnderscore:/_([^\s_](?:[^_\n]*?[^\s_])?)_/g,strikethrough:/~~([^\s~](?:[^~\n]*?[^\s~])?)~~/g,superscript:/\^([^\s^](?:[^^\n]*?[^\s^])?)\^/g,subscript:new RegExp("(?<!~)~(?!~)([^\\s~](?:[^~\\n]*?[^\\s~])?)~(?!~)","g"),autoLink:/<(https?:\/\/[^>\s]+)>/g,autoEmail:/<([^>\s]+@[^>\s]+\.[^>\s]+)>/g,htmlTag:/<\/?[a-zA-Z][a-zA-Z0-9-]*(?:[ \t]+[^>]*)?\/?>/g,image:/!\[([^\]]*)\]\(([^)]+)\)/g,link:/\[([^\]]+)\]\(([^)]+)\)/g,refImage:/!\[([^\]]*)\]\[([^\]]*)\]/g,refLink:/\[([^\]]+)\]\[([^\]]*)\]/g,footnoteRef:/\[\^([^\]]+)\]/g};function d(t){return t.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}let A={};function Ce(t){const s={},i=t.split(`
`);for(const a of i){const r=a.match(/^\[([^\]]+)\]:\s+(\S+)(?:\s+"([^"]*)")?$/);r&&(s[r[1].toLowerCase()]={url:r[2],title:r[3]||""})}return s}function q(t){const s=t.split(`
`),i=[];let a=0,r=0;if(s[0].match(/^---\s*$/)&&s.length>1){for(let e=1;e<s.length;e++)if(s[e].match(/^\s*---\s*$/)){const c=s.slice(0,e+1).join(`
`);i.push({type:"metadata",text:c,offset:0}),a=c.length+1,r=e+1;break}}for(;r<s.length;){const e=s[r];if(e.match(/^```/)){let c=r+1;for(;c<s.length&&!s[c].match(/^\s*```/);)c++;if(c<s.length){const f=s.slice(r,c+1).join(`
`);i.push({type:"code",text:f,offset:a}),a+=f.length+1,r=c+1;continue}}if(e.match(/^\$\$\s*$/)){let c=r+1;for(;c<s.length&&!s[c].match(/^\s*\$\$/);)c++;if(c<s.length){const f=s.slice(r,c+1).join(`
`);i.push({type:"math",text:f,offset:a}),a+=f.length+1,r=c+1;continue}}if(e.match(/^\|.*\|\s*$/)&&r+1<s.length){const c=s[r+1];if(c.match(/^\|(?:\s*:?-+:?\s*\|)+\s*$/)){const f=p=>p.split("|").length-1;if(f(e)===f(c)){let p=r+2;for(;p<s.length&&s[p].match(/^\|.*\|\s*$/);)p++;const m=s.slice(r,p).join(`
`);i.push({type:"table",text:m,offset:a}),a+=m.length+1,r=p;continue}}}if(e.match(/^\s*>(?:\s|$)/)){let c=r+1;for(;c<s.length&&s[c].match(/^\s*>(?:\s|$)/);)c++;const p=s.slice(r,c).map($=>{const b=$.match(/^(\s*>)(\s?)(.*)/);return b?{prefix:b[1]+b[2],content:b[3]}:{prefix:"",content:$}}),m=p.map($=>$.content).join(`
`),T=q(m);let k=0;for(const $ of T){const b=$.text.split(`
`).length,v=p.slice(k,k+b).map(_=>_.prefix),S=$.text.split(`
`).map((_,y)=>v[y]+_);i.push({type:$.type,text:S.join(`
`),offset:a,blockquote:!0,innerText:$.text,prefixes:v}),a+=S.join(`
`).length+1,k+=b}r=c;continue}if(e.match(/^#{1,6}[ \t]+.+$/)){i.push({type:"heading",text:e,offset:a}),a+=e.length+1,r++;continue}if(e!==""&&!e.match(/^\s*(---+|\*\*\*+|___+)\s*$/)&&!e.match(/^- /)&&(r===0||s[r-1]==="")&&r+1<s.length){const c=s[r+1];if(c.match(/^=+\s*$/)||c.match(/^-+\s*$/)){const f=e+`
`+c;i.push({type:"setext",text:f,offset:a}),a+=f.length+1,r+=2;continue}}if(e.match(/^\s*(---+|\*\*\*+|___+)\s*$/)){i.push({type:"hr",text:e,offset:a}),a+=e.length+1,r++;continue}if(e.match(/^(?: {4}|\t)/)&&!e.match(/^\s*[*\-+] /)&&!e.match(/^\s*\d+\. /)&&!e.match(/^\s*>(?:\s|$)/)){let c=r+1;for(;c<s.length&&s[c].match(/^(?: {4}|\t)/)&&!s[c].match(/^\s*[*\-+] /)&&!s[c].match(/^\s*\d+\. /)&&!s[c].match(/^\s*>(?:\s|$)/);)c++;const f=s.slice(r,c).join(`
`);i.push({type:"indented-code",text:f,offset:a}),a+=f.length+1,r=c;continue}i.push({type:"line",text:e,offset:a}),a+=e.length+1,r++}return i}function L(t){let s=t;const i=[],a=e=>{const c=`PROTECTED${i.length}`;return i.push(e),c};s=s.replace(w.escaped,(e,c)=>a(`<span class="md-syntax">\\</span>${d(c)}`)).replace(w.inlineCode,(e,c)=>a(`<code><span class="md-syntax">\`</span>${d(c)}<span class="md-syntax">\`</span></code>`)).replace(w.inlineMath,(e,c)=>a(`<code class="math"><span class="md-syntax">$</span>${d(c)}<span class="md-syntax">$</span></code>`)).replace(w.comment,(e,c)=>a(`<span class="comment">&lt;!--${d(c)}--&gt;</span>`)).replace(w.autoLink,(e,c)=>a(`<span class="md-syntax">&lt;</span><a href="${d(c)}" target="_blank" rel="noopener noreferrer">${d(c)}</a><span class="md-syntax">&gt;</span>`)).replace(w.autoEmail,(e,c)=>a(`<span class="md-syntax">&lt;</span><a href="mailto:${d(c)}">${d(c)}</a><span class="md-syntax">&gt;</span>`)).replace(w.htmlTag,e=>a(`<code class="md-syntax">${d(e)}</code>`)).replace(w.image,(e,c,f)=>a(`<span class="md-syntax">![</span>${d(c)}<span class="md-syntax">](</span><a href="${d(f)}" target="_blank" rel="noopener noreferrer">${d(f)}</a><span class="md-syntax">)</span>`)).replace(w.link,(e,c,f)=>a('<span class="md-syntax">[</span>')+c+a(`<span class="md-syntax">](</span><a href="${d(f)}" target="_blank" rel="noopener noreferrer">${d(f)}</a><span class="md-syntax">)</span>`)).replace(w.refImage,(e,c,f)=>{const p=(f||c).toLowerCase(),m=A[p];return m?a(`<span class="md-syntax">![</span>${d(c)}<span class="md-syntax">][</span><a href="${d(m.url)}" target="_blank" rel="noopener noreferrer">${d(f)}</a><span class="md-syntax">]</span>`):e}).replace(w.refLink,(e,c,f)=>{const p=(f||c).toLowerCase(),m=A[p];return m?a('<span class="md-syntax">[</span>')+c+a(`<span class="md-syntax">][</span><a href="${d(m.url)}" target="_blank" rel="noopener noreferrer">${d(f)}</a><span class="md-syntax">]</span>`):e}).replace(w.footnoteRef,(e,c)=>a('<span class="md-syntax">[^</span>')+c+a('<span class="md-syntax">]</span>')),s=d(s);const r=e=>`<span class="md-syntax">${e}</span>`;return s=s.replace(w.boldItalic,(e,c)=>a(`<b><em>${r("***")}`)+c+a(`${r("***")}</em></b>`)).replace(w.bold,(e,c)=>`<b>${r("**")}${c}${r("**")}</b>`).replace(w.boldUnderscore,(e,c)=>`<b>${r("__")}${c}${r("__")}</b>`).replace(w.strikethrough,(e,c)=>`<s>${r("~~")}${c}${r("~~")}</s>`).replace(w.superscript,(e,c)=>`<sup>${r("^")}${c}${r("^")}</sup>`).replace(w.subscript,(e,c)=>`<sub>${r("~")}${c}${r("~")}</sub>`).replace(w.italicAsterisk,(e,c)=>`<em>${r("*")}${c}${r("*")}</em>`).replace(w.italicUnderscore,(e,c)=>`<em>${r("_")}${c}${r("_")}</em>`),s=s.replace(/\uE000PROTECTED(\d+)\uE001/g,(e,c)=>i[parseInt(c,10)]),s}function Se(t){const s=t.match(/^(\s*)(>)(\s?)$/);if(!s)return d(t);const i=s[1],a=s[2],r=s[3];return i?`<span class="indent">${d(i)}</span><span class="md-syntax">${d(a)}</span>${r}`:`<span class="md-syntax">${d(a)}</span>${r}`}function Ee(t){return/^<\w+[^>]*\sclass="[^"]*bq/.test(t)?t:/^<\w+[^>]*\sclass="/.test(t)?t.replace(/^(<\w+[^>]*\sclass="[^"]*)(")/,"$1 bq$2"):t.replace(/^(<\w+)/,'$1 class="bq"')}function Le(t,s){const a=t.split(`
`).map((r,e)=>{const c=s[e];if(!c)return r;const f=Se(c),p=r.match(/^(<(?:pre|code|div|h[1-6])[^>]*>)*/),m=p?p[0].length:0,T=r.replace(/<br>/g,"");return T.slice(0,m)+f+T.slice(m)}).join(`
`);return Ee(a)}function U(t){if(t.blockquote){const s={type:t.type,text:t.innerText},i=U(s),a=Array.isArray(i)?i:[i];let r=0;const e=[];for(const c of a){const f=(c.match(/\n/g)||[]).length+1,p=t.prefixes.slice(r,r+f);e.push(Le(c,p)),r+=f}return e.length===1?e[0]:e}switch(t.type){case"metadata":{const s=t.text.split(`
`),i=`<span class="md-syntax">${d(s[0])}</span>`,a=`<span class="md-syntax">${d(s[s.length-1])}</span>`,r=s.slice(1,-1);return r.length>0?`<pre><code>${i}
${r.map(e=>d(e)).join(`
`)}
${a}</code></pre>`:`<pre><code>${i}
${a}</code></pre>`}case"code":{const s=t.text.match(/^(```[^\n]*)\n([\s\S]*?)\n(\s*```)$/);return s?`<pre><code><span class="md-syntax">${d(s[1])}</span>
${d(s[2])}
<span class="md-syntax">${d(s[3])}</span></code></pre>`:`<pre><code>${d(t.text)}</code></pre>`}case"indented-code":return`<pre><code>${d(t.text)}</code></pre>`;case"table":return`<pre><code>${t.text.split(`
`).map((a,r)=>{const e=d(a);return r===1?`<span class="md-syntax">${e}</span>`:e.replace(/\|/g,'<span class="md-syntax">|</span>')}).join(`
`)}</code></pre>`;case"math":{const s=t.text.match(/^(\$\$)\n([\s\S]*?)\n(\s*\$\$)$/);return s?`<pre><code class="math"><span class="md-syntax">${d(s[1])}</span>
${d(s[2])}
<span class="md-syntax">${d(s[3])}</span></code></pre>`:`<pre><code class="math">${d(t.text)}</code></pre>`}case"heading":{const s=t.text.match(/^(#{1,6}[ \t]+)(.*)/),i=s[1].trim().length;return`<h${i}><span class="md-syntax">${d(s[1])}</span>${L(s[2])}</h${i}>`}case"setext":{const s=t.text.indexOf(`
`),i=t.text.slice(0,s),a=t.text.slice(s+1),r=a.trimStart()[0]==="="?1:2;return`<h${r}>${L(i)}
<span class="md-rule md-syntax">${d(a)}</span></h${r}>`}case"hr":return`<div class="md-rule md-syntax">${d(t.text)}</div>`;case"line":{if(t.text==="")return'<div class="line"><br></div>';const s=t.text.match(/^(\*\[)([^\]]+)(\]:\s)(.*)/);if(s)return`<div class="line"><span class="md-syntax">${d(s[1])}</span>${d(s[2])}<span class="md-syntax">${d(s[3])}</span>${L(s[4])}</div>`;const i=t.text.match(/^(\[\^)([^\]]+)(\]:\s)(.*)/);if(i)return`<div class="line"><span class="md-syntax">${d(i[1])}</span>${d(i[2])}<span class="md-syntax">${d(i[3])}</span>${L(i[4])}</div>`;const a=t.text.match(/^(\[[^\]]+\]:\s+)(\S+)(\s+"[^"]*")?$/);if(a){const p=a[1],m=a[2],T=a[3]||"";return`<div class="line"><span class="md-syntax">${d(p)}</span><a href="${d(m)}" target="_blank" rel="noopener noreferrer">${d(m)}</a><span class="md-syntax">${d(T)}</span></div>`}const r=t.text.match(/^(\s*)([*\-+] )/);if(r){const p=r[1],m=r[2],T=t.text.slice(p.length+m.length),k=p?`<span class="indent">${d(p)}</span>`:"",$=T.match(/^(\[[ xX]\] )/);if($){const b=$[1],v=T.slice(b.length),_=b[1]!==" "?`<span class="task-done">${L(v)}</span>`:L(v);return`<div class="line list-line"><span class="list-marker">${k}<span class="md-syntax md-bullet">${d(m)}</span><span class="md-checkbox">${d(b)}</span></span><span class="list-content">${_}</span></div>`}return`<div class="line list-line"><span class="list-marker">${k}<span class="md-syntax md-bullet">${d(m)}</span></span><span class="list-content">${L(T)}</span></div>`}const e=t.text.match(/^(\s*)(\d+\. )/);if(e){const p=e[1],m=e[2],T=t.text.slice(p.length+m.length);return`<div class="line list-line"><span class="list-marker">${p?`<span class="indent">${d(p)}</span>`:""}<span class="md-syntax">${d(m)}</span></span><span class="list-content">${L(T)}</span></div>`}const c=t.text.match(/^(: )/);if(c){const p=c[1],m=t.text.slice(p.length);return`<div class="line list-line"><span class="list-marker"><span class="md-syntax">${d(p)}</span></span><span class="list-content">${L(m)}</span></div>`}const f=t.text.match(/^(\s+)/);if(f){const p=f[1],m=t.text.slice(p.length);return`<div class="line"><span class="indent">${d(p)}</span>${L(m)}</div>`}return`<div class="line">${L(t.text)}</div>`}}}function _e(t){return A=Ce(t),q(t).flatMap(i=>{const a=U(i);return Array.isArray(a)?a:[a]}).join("")}function Ne(t,s){document.addEventListener("keydown",i=>{if((i.metaKey||i.ctrlKey)&&i.key==="s"){i.preventDefault();const a=i.metaKey?"⌘S":"Ctrl+S";X(s,a)}})}function X(t,s){try{const a={content:t()},r=JSON.stringify(a),e=ae(r).then(f=>{const p=`${window.location.origin}${window.location.pathname}?#doc=${f}`;return new Blob([p],{type:"text/plain"})}),c=new ClipboardItem({"text/plain":e});navigator.clipboard.write([c]).then(()=>{Oe(s,"Link copied!")})}catch(i){console.error("Failed to copy link to clipboard:",i)}}function Oe(t,s){const i=document.querySelector(".signal-overlay");i&&i.remove();const a=document.createElement("div");a.className="signal-overlay";const r=document.createElement("div");if(r.className="signal",t){const c=document.createElement("span");c.className="signal-keys",c.textContent=t,r.appendChild(c)}const e=document.createElement("span");e.className="signal-message",e.textContent=s,r.appendChild(e),a.appendChild(r),document.body.appendChild(a),a.addEventListener("animationend",c=>{c.target===a&&a.remove()})}const De=3e3;function Pe(t,s){if(!("ontouchstart"in window))return;const i=Me();document.body.appendChild(i);let a;t.addEventListener("touchstart",()=>{i.classList.add("visible"),clearTimeout(a),a=setTimeout(()=>{i.classList.remove("visible")},De)},{passive:!0}),i.addEventListener("click",r=>{r.preventDefault(),X(s)})}function Me(){const t=document.createElement("button");return t.type="button",t.className="share-button",t.setAttribute("aria-label","Copy shareable link"),t.innerHTML=`<svg viewBox="0 0 24 24" width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
  <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"/>
  <polyline points="16 6 12 2 8 6"/>
  <line x1="12" y1="2" x2="12" y2="15"/>
</svg>`,t}const z=()=>document.body.classList.add("fonts-loaded");document.fonts.ready.then(z);setTimeout(z,2e3);document.addEventListener("DOMContentLoaded",async()=>{const t=document.querySelector(".paper");Ae();const s=window.location.hash.startsWith("#doc="),i=await le(),a=s?0:ue(),r=ke(t,i,_e,de,{initialCaretPosition:a,onCaretChange:fe});Ne(t,r.getText),Pe(t,r.getText),t.focus(),Ie(2e3)});function Ae(){const t=document.querySelector(".logo");t?.addEventListener("animationend",()=>t.remove(),{once:!0})}function Ie(t){let s;document.addEventListener("mousemove",()=>{document.body.classList.remove("hide-cursor"),clearTimeout(s),s=setTimeout(()=>{document.body.classList.add("hide-cursor")},t)},{passive:!0}),document.body.classList.add("hide-cursor")}
