(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))e(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&e(l)}).observe(document,{childList:!0,subtree:!0});function a(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function e(r){if(r.ep)return;r.ep=!0;const i=a(r);fetch(r.href,i)}})();const N=8192;async function j(n){if(n.length===0)return"";const s=await H(n),a=Array.from(s,e=>String.fromCodePoint(e)).join("");return btoa(a)}async function q(n){if(n.length===0)return"";const s=atob(n),a=Uint8Array.from(s,e=>e.charCodeAt(0));return await J(a)}function I(n){if(n.length===0)return"";const s=new TextDecoder,a=[],e=N-N%4;for(let r=0;r<n.length;r+=e){const i=n.slice(r,r+e),l=atob(i),m=new Uint8Array(l.length);for(let y=0;y<l.length;y++)m[y]=l.charCodeAt(y);a.push(s.decode(m,{stream:!0}))}return a.push(s.decode()),a.join("")}async function H(n){const s=new Blob([n]).stream().pipeThrough(new CompressionStream("gzip"));return new Uint8Array(await new Response(s).arrayBuffer())}async function J(n){const s=new Blob([n]).stream().pipeThrough(new DecompressionStream("gzip"));return await new Response(s).text()}async function Q(){const n=(await G()??Y())?.content||"";return V(),X(n)}function Z(n){const s={content:n};localStorage.setItem("editorState",JSON.stringify(s))}function X(n){if(!n)return"";if(/<[a-zA-Z][^>]*>/.test(n)){const s=document.createElement("div");return s.innerHTML=n,$(s)}return n}function V(){window.history.replaceState(null,"",window.location.pathname)}async function G(){const n=window.location.hash,s="#doc=",a="#json=";try{if(n.startsWith(s)){const e=await q(n.substring(s.length));return JSON.parse(e)}if(n.startsWith(a)){const e=I(n.substring(a.length));return JSON.parse(e)}return null}catch(e){return console.error("Error parsing URL state:",e.message),console.error("The URL appears to be truncated or corrupted."),null}}function Y(){const n=localStorage.getItem("editorState");if(!n)return null;try{return JSON.parse(n)}catch(s){return console.error("Error parsing saved state",s),null}}function $(n){let s="";for(const a of n.childNodes)a.nodeType===Node.TEXT_NODE?s+=a.textContent:a.nodeType===Node.ELEMENT_NODE&&(s+=$(a));return s}const p={metadata:/^---[ \t]*\n([\s\S]*?)\n?[ \t]*---/,codeBlock:/```([^\s`]*?)[ \t]*\n([\s\S]*?)\n[ \t]*```/g,table:/^\|[^\n]*\|[ \t]*\n\|(?:[ \t]*:?-+:?[ \t]*\|)+[ \t]*(?:\n\|[^\n]*\|[ \t]*)*/gm,heading:/^(#{1,6})[ \t]+(.+)$/gm,inlineCode:new RegExp("(?<!`)`(?!`)([^`\\n]+?)`(?!`)","g"),comment:/<!--([\s\S]*?)-->/g,bold:/\*\*([^\s\*](?:[^\*\n]*?[^\s\*])?)\*\*/g,italicAsterisk:new RegExp("(?<!\\*)\\*(?!\\*)([^\\s\\*](?:[^\\*\\n]*?[^\\s\\*])?)\\*(?!\\*)","g"),italicUnderscore:/_([^\s_](?:[^_\n]*?[^\s_])?)_/g,strikethrough:/~~([^\s~](?:[^~\n]*?[^\s~])?)~~/g,horizontalRule:/^[ \t]*(---+|\*\*\*+|___+)[ \t]*$/gm,htmlTag:/<\/?[a-zA-Z][a-zA-Z0-9-]*(?:[ \t]+[^>]*)?\/?>/g,blockquote:/^>(?:[ \t].*)?(?=\n)/gm,image:/!\[([^\]]*)\]\(([^)]+)\)/g,link:/\[([^\]]+)\]\(([^)]+)\)/g};function h(n){return n.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function ee(n){let s=n;const a=[],e=r=>{const i=`PROTECTED${a.length}`;return a.push(r),i};return s=s.replace(p.metadata,r=>e(`<pre><code>${h(r)}</code></pre>`)).replace(p.codeBlock,r=>e(`<pre><code>${h(r)}</code></pre>`)).replace(p.table,r=>{const i=r.split(`
`),l=m=>m.split("|").length-1;return l(i[0])!==l(i[1])?r:e(`<pre><code>${h(r)}</code></pre>`)}).replace(p.inlineCode,(r,i)=>e(`<code>\`${h(i)}\`</code>`)).replace(p.inlineCode,(r,i)=>e(()=>`<code>\`${h(i)}\`</code>`)).replace(p.comment,(r,i)=>e(`<span class="comment">&lt;!--${h(i)}--&gt;</span>`)).replace(p.htmlTag,r=>e(`<span class="html-tag">${h(r)}</span>`)).replace(p.blockquote,r=>`BLOCKQUOTE${r.slice(1)}`).replace(p.image,(r,i,l)=>e(`<a href="${h(l)}" target="_blank" rel="noopener noreferrer">![${h(i)}](${h(l)})</a>`)).replace(p.link,(r,i,l)=>e(`<a href="${h(l)}" target="_blank" rel="noopener noreferrer">[${h(i)}](${h(l)})</a>`)),s=h(s),s=s.replace(p.horizontalRule,r=>`<span class="hr">${r}</span>`).replace(p.heading,(r,i)=>`<h${i.length}>${r}</h${i.length}>`).replace(p.bold,(r,i)=>`<b>**${i}**</b>`).replace(p.strikethrough,(r,i)=>`<s>~~${i}~~</s>`).replace(p.italicAsterisk,(r,i)=>`<em>*${i}*</em>`).replace(p.italicUnderscore,(r,i)=>`<em>_${i}_</em>`).replace(/(\uE002BLOCKQUOTE\uE003.*(?:\n\uE002BLOCKQUOTE\uE003.*)*)/g,r=>`<blockquote>${r.replace(/\uE002BLOCKQUOTE\uE003/g,"&gt;")}</blockquote>`).replace(/\uE000PROTECTED(\d+)\uE001/g,(r,i)=>a[parseInt(i,10)]),s}function te(n,s,a){let e=s;const r=[],i=[];let l=0,m="",y=!1;function b(o,t,c){try{const u=document.createRange();return u.setStart(o,0),u.setEnd(t,c),u.toString().length}catch{return 0}}function T(){const o=window.getSelection();return o.rangeCount?b(n,o.focusNode,o.focusOffset):0}function S(){const o=window.getSelection();if(!o.rangeCount)return{start:0,end:0};const t=b(n,o.anchorNode,o.anchorOffset),c=b(n,o.focusNode,o.focusOffset);return{start:Math.min(t,c),end:Math.max(t,c)}}function C(o){const t=window.getSelection(),c=document.createTreeWalker(n,NodeFilter.SHOW_TEXT);let u=o;for(;c.nextNode();){const w=c.currentNode.textContent.length;if(u<=w){t.collapse(c.currentNode,u);return}u-=w}const d=c.currentNode;d&&d!==n?t.collapse(d,d.textContent?.length||0):t.collapse(n,n.childNodes.length)}function k(){const o=window.getSelection();if(!o.rangeCount)return;const t=o.getRangeAt(0).getBoundingClientRect();if(!t||t.height===0)return;const c=n.getBoundingClientRect(),u=40;t.bottom>c.bottom-u?n.scrollBy({top:t.bottom-c.bottom+u,behavior:"smooth"}):t.top<c.top+u&&n.scrollBy({top:t.top-c.top-u,behavior:"smooth"})}function f(o,t){const c=Date.now();if(o===m&&c-l<500&&r.length>0){l=c;return}r.push({text:e,offset:t}),i.length=0,l=c,m=o}function v(){if(r.length===0)return;i.push({text:e,offset:T()});const o=r.pop();e=o.text,E(),C(o.offset),k(),a(e)}function O(){if(i.length===0)return;r.push({text:e,offset:T()});const o=i.pop();e=o.text,E(),C(o.offset),k(),a(e)}function B(o){if(o===0)return 0;let t=o;for(;t>0&&/\s/.test(e[t-1]);)t--;for(;t>0&&!/\s/.test(e[t-1]);)t--;return t}function _(o){const t=e.length;if(o>=t)return t;let c=o;for(;c<t&&!/\s/.test(e[c]);)c++;for(;c<t&&/\s/.test(e[c]);)c++;return c}function D(o){if(o===0)return 0;let t=o;for(;t>0&&e[t-1]!==`
`;)t--;return t}function A(o){const t=e.length;if(o>=t)return t;let c=o;for(;c<t&&e[c]!==`
`;)c++;return c}function E(){n.innerHTML=ee(e)}function g(o){E(),C(o),k(),a(e)}function P(o){if(y||o.inputType==="insertCompositionText"||(o.preventDefault(),o.inputType==="insertFromPaste"||o.inputType==="deleteByCut"))return;const{start:t,end:c}=S(),u=t!==c;switch(o.inputType){case"insertText":{const d=o.data||"";f("insertText",t),e=e.slice(0,t)+d+e.slice(c),g(t+d.length);break}case"insertParagraph":case"insertLineBreak":{f("insertLine",t),e=e.slice(0,t)+`
`+e.slice(c),g(t+1);break}case"deleteContentBackward":{u?(f("delete",t),e=e.slice(0,t)+e.slice(c),g(t)):t>0&&(f("delete",t),e=e.slice(0,t-1)+e.slice(t),g(t-1));break}case"deleteContentForward":{u?(f("delete",t),e=e.slice(0,t)+e.slice(c),g(t)):t<e.length&&(f("delete",t),e=e.slice(0,t)+e.slice(t+1),g(t));break}case"deleteWordBackward":{if(u)f("deleteWord",t),e=e.slice(0,t)+e.slice(c),g(t);else{const d=B(t);d<t&&(f("deleteWord",t),e=e.slice(0,d)+e.slice(t),g(d))}break}case"deleteWordForward":{if(u)f("deleteWord",t),e=e.slice(0,t)+e.slice(c),g(t);else{const d=_(t);d>t&&(f("deleteWord",t),e=e.slice(0,t)+e.slice(d),g(t))}break}case"deleteSoftLineBackward":case"deleteHardLineBackward":{if(u)f("deleteLine",t),e=e.slice(0,t)+e.slice(c),g(t);else{const d=D(t);d<t&&(f("deleteLine",t),e=e.slice(0,d)+e.slice(t),g(d))}break}case"deleteSoftLineForward":case"deleteHardLineForward":{if(u)f("deleteLine",t),e=e.slice(0,t)+e.slice(c),g(t);else{const d=A(t);d>t&&(f("deleteLine",t),e=e.slice(0,t)+e.slice(d),g(t))}break}case"historyUndo":{v();break}case"historyRedo":{O();break}case"insertReplacementText":{const d=o.getTargetRanges();if(d.length>0){const w=d[0],L=b(n,w.startContainer,w.startOffset),M=b(n,w.endContainer,w.endOffset),x=o.dataTransfer?.getData("text/plain")||o.data||"";f("replace",L),e=e.slice(0,L)+x+e.slice(M),g(L+x.length)}break}}}function R(){y=!0}function U(){y=!1;const o=T();e=n.textContent||"",E(),C(o),a(e)}function K(o){o.preventDefault();const{start:t,end:c}=S();t!==c&&o.clipboardData.setData("text/plain",e.slice(t,c))}function z(o){o.preventDefault();const{start:t,end:c}=S();t!==c&&(o.clipboardData.setData("text/plain",e.slice(t,c)),f("cut",t),e=e.slice(0,t)+e.slice(c),g(t))}function F(o){o.preventDefault();const t=o.clipboardData.getData("text/plain");if(!t)return;const{start:c,end:u}=S();f("paste",c),e=e.slice(0,c)+t+e.slice(u),g(c+t.length)}function W(o){(o.metaKey||o.ctrlKey)&&o.key==="z"&&(o.preventDefault(),o.shiftKey?O():v())}return n.addEventListener("keydown",W),n.addEventListener("beforeinput",P),n.addEventListener("compositionstart",R),n.addEventListener("compositionend",U),n.addEventListener("copy",K),n.addEventListener("cut",z),n.addEventListener("paste",F),E(),{getText:()=>e}}function ne(n,s){const a=document.querySelector(".signal-overlay");a&&a.remove();const e=document.createElement("div");e.className="signal-overlay";const r=document.createElement("div");r.className="signal";const i=document.createElement("span");i.className="signal-keys",i.textContent=n;const l=document.createElement("span");l.className="signal-message",l.textContent=s,r.appendChild(i),r.appendChild(l),e.appendChild(r),document.body.appendChild(e),e.addEventListener("animationend",m=>{m.target===e&&e.remove()})}function oe(n){document.addEventListener("keydown",s=>{if((s.metaKey||s.ctrlKey)&&s.key==="s"){s.preventDefault();const a=s.metaKey?"⌘S":"Ctrl+S";re(n,a)}})}async function re(n,s){try{const e={content:n.textContent},r=JSON.stringify(e),i=j(r),l=`${window.location.origin}${window.location.pathname}?#doc=${i}`;await navigator.clipboard.writeText(l),ne(s,"Link copied!")}catch(a){console.error("Failed to copy link to clipboard:",a)}}document.addEventListener("DOMContentLoaded",async()=>{const n=document.querySelector(".paper");se();const s=await Q();te(n,s,Z),oe(n),n.focus(),ie(2e3)});function se(){const n=document.querySelector(".logo");n?.addEventListener("animationend",()=>n.remove(),{once:!0})}function ie(n){let s;document.addEventListener("mousemove",()=>{document.body.classList.remove("hide-cursor"),clearTimeout(s),s=setTimeout(()=>{document.body.classList.add("hide-cursor")},n)},{passive:!0}),document.body.classList.add("hide-cursor")}
